<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Password Policy</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
    integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="password.js"></script>

</head>

<body class="p-5">
  <div id="login-form" class="offset-3 col-6 col-lg-6">
    <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1"><i class="fa fa-user"></i></span>
      <input type="text" class="form-control" id="username" placeholder="Username" aria-label="Username"
        aria-describedby="basic-addon1">
    </div>
    <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon2"><i class="fa fa-key"></i></span>
      <input type="password" class="form-control" id="password" placeholder="Password" aria-label="Password"
        aria-describedby="basic-addon2">
      <span class="input-group-text"><i class="fa fa-duotone fa-eye fa-beat" id="togglePassword"
          style="cursor: pointer;" title="Show Password"></i></span>
      <span class="input-group-text"><i class="fa fa-duotone fa-repeat fa-beat-fade" id="genPassword"
            style="cursor: pointer;" title="Generate random Password"></i></span> 
      <div class="valid-feedback" id="validPassword" style="display: none;">Password Looks good!</div>
      <div class="invalid-feedback" id="invalidPassword" style="display: none;">Use a strong password!</div>
    </div>
	<p class="text-info"><i class="fa fa-duotone fa-info-circle"></i> <small>Validation works with minimum 3 characters.</small></p>

    <div id="passwordCheckboxContainer">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkLengthCount" disabled>
        <label class="form-check-label" for="chkLengthCount">Minimum Length count</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkLowerCount" disabled>
        <label class="form-check-label" for="chkLowerCount">Minimum lower case count</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkUpperCount" disabled>
        <label class="form-check-label" for="chkUpperCount">Minimum upper case count</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkDigitCount" disabled>
        <label class="form-check-label" for="chkDigitCount">Minimum digit count</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkSpecialCount" disabled>
        <label class="form-check-label" for="chkSpecialCount">Minimum special character count</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsCommon" disabled>
        <label class="form-check-label" for="chkIsCommon">Password is not in common passwords</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsPersonal" disabled>
        <label class="form-check-label" for="chkIsPersonal">Password is not in personal keywords</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsSequential" disabled>
        <label class="form-check-label" for="chkIsSequential">Password is not sequential (on keyboard)</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsRepeated" disabled>
        <label class="form-check-label" for="chkIsRepeated">Password is not repeated</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsDictionary" disabled>
        <label class="form-check-label" for="chkIsDictionary">Password is not a dictionary word</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsDefault" disabled>
        <label class="form-check-label" for="chkIsDefault">Password is not a default or suggested password</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsUsernameOrHost" disabled>
        <label class="form-check-label" for="chkIsUsernameOrHost">Password is not a username or host name</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsSingleDigit" disabled>
        <label class="form-check-label" for="chkIsSingleDigit">Password is not followed or preceded by a single
          digit</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="chkIsIncremental" disabled>
        <label class="form-check-label" for="chkIsIncremental">Password is not incremental</label>
      </div>
    </div>
  </div>
  <script>
    $(document).ready(function(){
      $("#password").on('change keyup paste input propertychange', function(){
        //setTimeout(function(){
          checkPassword();
        //},500);        
      });
    });
    function checkPassword() {
      var password = $("#password").val();
      if (checkPasswordSecurity(password)) {
        $("#password").removeClass('is-invalid').addClass('is-valid');
        $('#validPassword').show();
        $('#invalidPassword').hide();
      } else {
        $("#password").removeClass('is-valid').addClass('is-invalid');
        $('#validPassword').hide();
        $('#invalidPassword').show();
      }
      $('#passwordCheckboxContainer .form-check-input').prop('checked', false);
      if (password.length >= 3) { // minLength
        $('#chkLengthCount').prop('checked', PasswordChecks.lengthCount);
        $('#chkLowerCount').prop('checked', PasswordChecks.lowerCount);
        $('#chkUpperCount').prop('checked', PasswordChecks.upperCount);
        $('#chkDigitCount').prop('checked', PasswordChecks.digitCount);
        $('#chkSpecialCount').prop('checked', PasswordChecks.specialCount);
        $('#chkIsCommon').prop('checked', PasswordChecks.isCommon);
        $('#chkIsPersonal').prop('checked', PasswordChecks.isPersonal);
        $('#chkIsSequential').prop('checked', PasswordChecks.isSequential);
        $('#chkIsRepeated').prop('checked', PasswordChecks.isRepeated);
        $('#chkIsDictionary').prop('checked', PasswordChecks.isDictionary);
        $('#chkIsDefault').prop('checked', PasswordChecks.isDefault);
        $('#chkIsUsernameOrHost').prop('checked', PasswordChecks.isUsernameOrHost);
        $('#chkIsSingleDigit').prop('checked', PasswordChecks.isSingleDigit);
        $('#chkIsIncremental').prop('checked', PasswordChecks.isIncremental);
      }
    }

    $(document).on('click', '#togglePassword', function () {
      var input = $("#password");
      var icon = $('#togglePassword');
      icon.toggleClass("fa-eye fa-eye-slash");
      if (input.attr('type') === 'password') {
        input.attr('type', 'text');
        icon.attr('title', 'Hide password')
      }
      else {
        input.attr('type', 'password');
        icon.attr('title', 'Show password');
      }
    });
    $(document).on('click', '#genPassword', function () {
      $("#password").val(getSecureStrongPassword());
      checkPassword();
    });

  </script>
</body>

</html>